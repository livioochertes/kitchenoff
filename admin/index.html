<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KitchenOff Admin Panel</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    .login-container {
      max-width: 450px;
      margin: 80px auto;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 50px;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.2);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .login-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .login-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .login-logo img {
      width: 80px;
      height: 80px;
      border-radius: 12px;
    }
    
    .login-title {
      font-size: 32px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }
    
    .login-subtitle {
      color: #666;
      font-size: 16px;
    }
    
    .admin-header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 20px 30px;
      border-radius: 12px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 28px;
      font-weight: bold;
      color: #667eea;
    }
    
    .logo img {
      width: 60px;
      height: 60px;
      border-radius: 10px;
    }
    
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    
    .btn-secondary:hover {
      background: #5a6268;
    }
    
    .form-input {
      width: 100%;
      padding: 15px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 16px;
      margin-bottom: 20px;
      transition: border-color 0.3s ease;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .loading-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: white;
    }
    
    .loading {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .nav-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 10px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .nav-tab {
      flex: 1;
      padding: 15px 20px;
      border: none;
      background: transparent;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      color: #666;
      transition: all 0.3s ease;
    }
    
    .nav-tab:hover {
      background: rgba(102, 126, 234, 0.1);
      color: #667eea;
    }
    
    .nav-tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .content-area {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 1px solid #f5c6cb;
    }
    
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
      <div class="login-header">
        <div class="login-logo">
          <img src="/attached_assets/KitchenOff_Logo_Background_Removed_1752520997429.png" alt="KitchenOff Logo" />
        </div>
        <h1 class="login-title">KitchenOff Admin</h1>
        <p class="login-subtitle">Secure Admin Access</p>
      </div>
      
      <div id="error-message" class="error-message hidden"></div>
      
      <form id="login-form">
        <input
          type="email"
          id="email"
          class="form-input"
          placeholder="Email"
          required
        />
        <input
          type="password"
          id="password"
          class="form-input"
          placeholder="Password"
          required
        />
        <button
          type="submit"
          class="btn"
          id="login-btn"
          style="width: 100%"
        >
          Login
        </button>
      </form>
    </div>
    
    <!-- Admin Dashboard -->
    <div id="dashboard-screen" class="hidden">
      <div class="container">
        <div class="admin-header">
          <div class="logo">
            <img src="/attached_assets/KitchenOff_Logo_Background_Removed_1752520997429.png" alt="KitchenOff Logo" />
            <span>KitchenOff Admin</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px;">
            <span style="font-size: 14px; color: #666;" id="welcome-text">Welcome, Admin</span>
            <button id="logout-btn" class="btn btn-secondary" style="padding: 8px 16px; font-size: 14px;">
              Logout
            </button>
          </div>
        </div>
        
        <div class="nav-tabs">
          <button class="nav-tab active" data-tab="dashboard">
            üìä Dashboard
          </button>
          <button class="nav-tab" data-tab="settings">
            ‚öôÔ∏è Settings
          </button>
        </div>
        
        <div class="content-area">
          <div id="dashboard-content">
            <h2>Dashboard</h2>
            <p>Welcome to the KitchenOff Admin Panel!</p>
            <p>Admin interface is now working correctly!</p>
          </div>
          
          <div id="settings-content" class="hidden">
            <h2>Settings</h2>
            <p>Settings management functionality will be implemented here.</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-container hidden">
      <div class="loading"></div>
      <p>Loading admin panel...</p>
    </div>
  </div>
  
  <script>
    // Check for existing session on page load
    document.addEventListener('DOMContentLoaded', function() {
      const savedToken = localStorage.getItem('adminToken');
      const savedAdmin = localStorage.getItem('adminUser');
      
      if (savedToken && savedAdmin) {
        try {
          const admin = JSON.parse(savedAdmin);
          showDashboard(admin);
        } catch (err) {
          console.error('Error parsing saved admin data:', err);
          localStorage.removeItem('adminToken');
          localStorage.removeItem('adminUser');
          showLogin();
        }
      } else {
        showLogin();
      }
    });
    
    // Login form handler
    document.getElementById('login-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const loginBtn = document.getElementById('login-btn');
      const errorDiv = document.getElementById('error-message');
      
      loginBtn.textContent = 'Logging in...';
      loginBtn.disabled = true;
      errorDiv.classList.add('hidden');
      
      try {
        const response = await fetch('/admin/api/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ email, password })
        });
        
        const data = await response.json();
        
        if (response.ok) {
          localStorage.setItem('adminToken', data.token);
          localStorage.setItem('adminUser', JSON.stringify(data.admin));
          showDashboard(data.admin);
        } else {
          showError(data.message || 'Login failed');
        }
      } catch (err) {
        showError('Network error. Please try again.');
      } finally {
        loginBtn.textContent = 'Login';
        loginBtn.disabled = false;
      }
    });
    
    // Logout handler
    document.getElementById('logout-btn').addEventListener('click', async function() {
      const token = localStorage.getItem('adminToken');
      
      try {
        await fetch('/admin/api/logout', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`
          }
        });
      } catch (err) {
        console.error('Logout error:', err);
      }
      
      localStorage.removeItem('adminToken');
      localStorage.removeItem('adminUser');
      showLogin();
    });
    
    // Tab switching
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        const tabName = this.dataset.tab;
        switchTab(tabName);
      });
    });
    
    // Helper functions
    function showLogin() {
      document.getElementById('login-screen').classList.remove('hidden');
      document.getElementById('dashboard-screen').classList.add('hidden');
      document.getElementById('loading-screen').classList.add('hidden');
    }
    
    function showDashboard(admin) {
      document.getElementById('welcome-text').textContent = `Welcome, ${admin.firstName || 'Admin'}`;
      document.getElementById('login-screen').classList.add('hidden');
      document.getElementById('dashboard-screen').classList.remove('hidden');
      document.getElementById('loading-screen').classList.add('hidden');
    }
    
    function showError(message) {
      const errorDiv = document.getElementById('error-message');
      errorDiv.textContent = message;
      errorDiv.classList.remove('hidden');
    }
    
    function switchTab(tabName) {
      // Update active tab
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
      
      // Show/hide content
      document.getElementById('dashboard-content').classList.add('hidden');
      document.getElementById('settings-content').classList.add('hidden');
      document.getElementById(`${tabName}-content`).classList.remove('hidden');
    }
  </script>
</body>
</html>